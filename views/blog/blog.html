<!DOCTYPE html>
<html>
<head>
	<!-- //Favicon tags -->
	<link rel="apple-touch-icon" sizes="57x57" href="images/favicon/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="images/favicon/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/favicon/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="images/favicon/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/favicon/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="images/favicon/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="images/favicon/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="images/favicon/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="images/favicon/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192"  href="images/favicon/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="images/favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="images/favicon/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="images/favicon/favicon-16x16.png">
	<link rel="manifest" href="images/favicon/manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="images/favicon/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">

	<title><%= title %></title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"/>
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700,900" rel="stylesheet">
	<link rel="stylesheet" href="/css/bootstrap.min.css">
	<link rel="stylesheet" href="/style/style.css" />
	<link rel="stylesheet" href="/css/jquery.mmenu.all.css"/>
	<script src="/js/jquery.min.js"></script>
	<script src="/js/bootstrap.min.js"></script>
	<script src="/js/jquery.mmenu.all.js"></script>
	<script defer src="https://use.fontawesome.com/releases/v5.0.9/js/all.js" integrity="sha384-8iPTk2s/jMVj81dnzb/iFR2sdA7u06vHJyyLlAd4snFpCl/SnyUjRrbdJsw1pGIl" crossorigin="anonymous"></script>
</head>

<body>
	<div id="wrap">

		<header class = "fluid-container">
			<div class="container">
				<div class="row">
					<div class="col-3 mr-auto">
						<!-- <img class="newappIcon" src="images/e-office_logo.svg"> -->
						<a class="logo" href="/">
							<img class="newappIcon" src="images/talkteam_logo1.png">
						</a>
					</div>
					<div class="col-2 col-sm-9 col-xs-9 col-auto">
						<% if (typeof lang == 'undefined' || lang == 'en') { %>
						<div class="mobile-lang">
							<a href="/?clang=nl"><img src="images/nl.png" alt="Dutch flag" height="34" width="34"></a>
						</div>
						<% } else if (lang == 'nl') { %>
							<div class="mobile-lang">
								<a href="/?clang=en"><img src="images/en.png" alt="British flag" height="34" width="34"></a>
							</div>
						<% } %>
						<a id="hamburger" href="#mainmenu"></a>
						<nav id="mainmenu">
							<ul>
								<% if (typeof lang == 'undefined' || lang == 'en') { %>
									<li><a href="/home">Home</a></li>
									<li><a href="/blog">News</a></li>
									<li><a href="/faq">F.A.Q</a></li>
									<% if (!username) { %>
										<li>
											<a href="/register">Buy</a>
										</li>
										<li>
											<a href="/login">Login</a>
										</li>
									<% } else if (username) { %>
										<li><a href="/downloads">Downloads</a></li>
										<li><a href="/service_request">Service Request</a></li>
									<% } %>
									<li><a href="/about">E-Office</a></li>
									<li><a href="/terms">Terms & Conditions</a></li>
								<% } else if (lang == 'nl') { %>
									<li><a href="/home">Home</a></li>
									<li><a href="/blog">Nieuws</a></li>
									<li><a href="/faq">F.A.Q</a></li>
									<% if (!username) { %>
										<li><a href="/login">Login</a></li>
									<% } else if (username) { %>
										<li><a href="/downloads">Downloads</a></li>
									<% } %>
									<li><a href="/about">E-Office</a></li>
									<li><a href="/terms">Algemene voorwaarde</a></li>
								<% } %>
								<% if (typeof lang == 'undefined' || lang == 'en') { %>
									<li class="lang"><a href="?clang=nl"><img src="images/nl.png" title="Translate to: Dutch" alt="Dutch flag" height="34" width="34"></a></li>
								<% } else if (lang == 'nl') { %>
									<li class="lang"><a href="?clang=en"><img src="images/en.png" title="Vertaal naar: Engels" alt="British flag" height="34" width="34"></a></li>
								<% } %>
							</ul>
						</nav>
						<div class="login">
							<% if (username) { %>
								<a id="logoutButton" href="/logout" style="margin-right: -4px">Logout</a>
							<% } %>
							<% if (!username) { %>
								<a id="loginButton" href="/login">Login</a>
							<% } %>
						</div>
					</div>
				</div>
			</div>
		</header>

<div class="fluid-container">
	<div class="row">
		<div class="col">
			<img class="bannerimg" src="images/apples-talkteam.png">
		</div>
	</div>
</div>

<section class="container main">

		<% for(var i=0; i < blog_posts.length; i++) { %>
			<article class="blog_post">
				<% if (typeof admin == 'undefined') { %>
					<!-- /no admin buttons -->
				<% } else if (admin) { %>
					<!-- // admin buttons -->
					<% if (username && admin) { %>
						<!-- enctype="multipart/form-data"  in form tag-->
							<form class="blog_post blog_post_form closed shortForm" action="/post/blog_edit" method="post" enctype="multipart/form-data">
								<% if (typeof lang == 'undefined' || lang == 'en') { %>
									<header>
										<label for="blogpost_title">Title:</label>
										<input type="hidden" id="blog_post_old_title" name="blogpost_old_title" value="<%= blog_posts[i].blogpost_title %>"/>
										<!-- <input type="hidden" id="blogpost_date" name="blogpost_date" value="<%= blog_posts[i].blogpost_date %>"/>
										<input type="hidden" id="blogpost_unique_date" name="blogpost_unique_date" value="<%= blog_posts[i].blogpost_unique_date %>"/> -->
										<!-- <input type="hidden" id="blogpost_date_format" name="blogpost_date_format" value="<%= blog_posts[i].blogpost_date_format %>"/> -->
										<input type="text" id="blogpost_title" placeholder="<%= blog_posts[i].blogpost_title %>" name="blogpost_title"/>
										<label for="blogpost_title_nl">Title (NL):</label>
										<input type="text" id="blogpost_title_nl" placeholder="<%= blog_posts[i].blogpost_title_nl %>" name="blogpost_title_nl"/>
									</header>
									<div class="body">
										<label for="blogpost_body">Content:</label>
										<textarea type="text" id="blogpost_body" placeholder="<%= blog_posts[i].blogpost_body %>" name="blogpost_body"/></textarea>
										<label for="blogpost_body_nl">Content (NL):</label>
										<textarea type="text" id="blogpost_body_nl" placeholder="<%= blog_posts[i].blogpost_body_nl %>" name="blogpost_body_nl"/></textarea>
										<label for="replaceFile"><% if (typeof lang == 'undefined' || lang == 'en') { %>Replace file <% } else if (lang == 'nl') { %>Bestand vervangen <% } %></label>
										<input type="checkbox" name="replaceFile" value="">
										<div class="extra">
											<label for="blogpost_file_edit_<%= [i] %>" id="buttonlabel" class="edit_blog">
												<span role="button" aria-controls="filename_edit_<%= [i] %>" tabindex="0">
													<i class="fas fa-upload"></i><% if (typeof lang == 'undefined' || lang == 'en') { %>Choose a file..<% } else if (lang == 'nl') { %>Bestand kiezen..<% } %>
												</span>
											</label>
											<input type="file" name="blogpost_file_edit" id="blogpost_file_edit_<%= [i] %>" class="blogpost_file_edit">

											<label for="filename_edit_<%= [i] %>" class="hide">
												uploaded file
											</label>
											<input type="text" id="filename_edit_<%= [i] %>" class="filename_edit" autocomplete="off" readonly placeholder="<% if (typeof lang == 'undefined' || lang == 'en') { %>No file selected, with this action you will overwrite the old upload(file)<% } else if (lang == 'nl') { %>Geen bestand geselecteerd , u overschrijft de vorige upload(bestand) hiermee.<% } %>">
										</div>
									</div>
									<footer>
								<% } else if (lang == 'nl') { %>
									<header>
										<label for="blogpost_title_nl">Titel:</label>
										<input type="text" id="blogpost_title_nl" placeholder="<%= blog_posts[i].blogpost_title_nl %>"name="blogpost_title_nl"/>
										<label for="blogpost_title">Titel (EN):</label>
										<input type="text" id="blogpost_title" placeholder="<%= blog_posts[i].blogpost_title %>" name="blogpost_title"/>
									</header>
									<div class="body">
										<label for="blogpost_body_nl">Inhoud:</label>
										<textarea type="text" id="blogpost_body_nl" placeholder="<%= blog_posts[i].blogpost_body_nl %>" name="blogpost_body_nl"/></textarea>
										<label for="blogpost_body">Inhoud (EN):</label>
										<textarea type="text" id="blogpost_body" placeholder="<%= blog_posts[i].blogpost_body %>" name="blogpost_body"/></textarea>
										<input type="checkbox" name="replaceFile" value="">
										<label for="replaceFile"><% if (typeof lang == 'undefined' || lang == 'en') { %>Replace file <% } else if (lang == 'nl') { %>Bestand vervangen <% } %></label>
										<div class="extra">
											<label for="blogpost_file_edit_<%= [i] %>" id="buttonlabel" class="edit_blog">
												<span role="button" aria-controls="filename_edit_<%= [i] %>" tabindex="0">
													<i class="fas fa-upload"></i><% if (typeof lang == 'undefined' || lang == 'en') { %>Choose a file..<% } else if (lang == 'nl') { %>Bestand kiezen..<% } %>
												</span>
											</label>
											<input type="file" name="blogpost_file_edit" id="blogpost_file_edit_<%= [i] %>" class="blogpost_file_edit">

											<label for="filename_edit_<%= [i] %>" class="hide">
												uploaded file
											</label>
											<input type="text" id="filename_edit_<%= [i] %>" class="filename_edit" autocomplete="off" readonly placeholder="<% if (typeof lang == 'undefined' || lang == 'en') { %>No file selected, with this action you will overwrite the old upload(file)<% } else if (lang == 'nl') { %>Geen bestand geselecteerd , u overschrijft de vorige upload(bestand) hiermee.<% } %>">
										</div>
									</div>
									<footer>
								<% } %>



									<!-- <pre>Date: <%= timeStampFormat %></pre> -->
									<input type="hidden" name="blogpost_id" value="<%=  blog_posts[i]._id %>"/>
									<input type="hidden" name="blogpost_unique_date" value="<%= uniqueTimeStamp %>"/>
									<input type="hidden" name="blogpost_date" value="<%= timeStamp %>"/>
									<input type="hidden" name="blogpost_date_format" value="<%= timeStampFormat %>"/>
								</footer>
								<input type="submit" value="<% if (typeof lang == 'undefined' || lang == 'en') { %>Send<% } else if (lang == 'nl') { %>Verzenden<% } %>">
							</form>
					<% } %>


					<div class="blog_edit_button">
						<i class="fas fa-edit"></i>
					</div>
					<form method="post" action="/delete/blog_post" class="shortForm blog_delete_form">
						<input type="hidden" name="blogpost_title" value="<%= blog_posts[i].blogpost_title %>">
						<input type="hidden" name="blogpost_date" value="<%= blog_posts[i].blogpost_date %>">
						<input type="hidden" name="blogpost_unique_date" value="<%= blog_posts[i].blogpost_unique_date %>">
						<input type="hidden" name="blogpost_id" value="<%= blog_posts[i]._id %>">
						<input type="submit" value="X">
					</form>
				<% } %>

				<!-- //blog post itself -->
				<div class="currentForm">

					<header>
						<% if (typeof lang == 'undefined' || lang == 'en') { %>
							<h2><%= blog_posts[i].blogpost_title %></h2>
						<% } else if (lang == 'nl') { %>
							<h2><%= blog_posts[i].blogpost_title_nl %></h2>
						<% } %>
					</header>
					<div class="body">
						<% if (typeof lang == 'undefined' || lang == 'en') { %>
							<pre><%= blog_posts[i].blogpost_body %></pre>
						<% } else if (lang == 'nl') { %>
							<pre><%= blog_posts[i].blogpost_body_nl %></pre>
						<% } %>

					</div>
					<footer>
						<% if (typeof blog_posts[i].blogpost_file == 'undefined') { %>
							<% } else if (blog_posts[i].blogpost_file) { %>
								<% if ( blog_posts[i].blogpost_file['mimetype'].startsWith("image") ) { %>
									<img src="../uploads/<%= Object(blog_posts[i].blogpost_file['filename']) %>" alt="">
								<% } %>
								<% if ( blog_posts[i].blogpost_file['mimetype'] == "application/vnd.openxmlformats-officedocument.presentationml.presentation" ) { %>
									<a href="../uploads/<%= Object(blog_posts[i].blogpost_file['filename']) %>" alt="">
										<%= Object(blog_posts[i].blogpost_file['originalname']) %>
									</a>
								<% } %>
								<% if ( blog_posts[i].blogpost_file['mimetype'] == "video/mp4" ) { %>
									<video controls>
										<source src="../uploads/<%= Object(blog_posts[i].blogpost_file['filename']) %>" type="video/mp4">
									</video>
									<span>
										<%= Object(blog_posts[i].blogpost_file['originalname']) %>
									</span>
								<% } %>

						<% } %>
						<pre><%= blog_posts[i].blogpost_date_format %></pre>

					</footer>

			</div>

			</article>
		<% } %>

		<% if (username && admin) { %>
			<article class="blog_post">
				<form id="blog_post_form" class="shortForm" action="/post/blog_post" method="post" enctype="multipart/form-data">
					<% if (typeof lang == 'undefined' || lang == 'en') { %>
						<header>
							<label for="blogpost_title">Title:</label>
							<input type="text" id="blogpost_title" name="blogpost_title"/>
							<label for="blogpost_title_nl">Title (NL):</label>
							<input type="text" id="blogpost_title_nl" name="blogpost_title_nl"/>
						</header>
						<div class="body">
							<label for="blogpost_body">Content:</label>
							<textarea type="text" id="blogpost_body" name="blogpost_body"/></textarea>
							<label for="blogpost_body_nl">Content (NL):</label>
							<textarea type="text" id="blogpost_body_nl" name="blogpost_body_nl"/></textarea>

							<label for="blogpost_file" id="buttonlabel">
								<span role="button" aria-controls="filename" tabindex="0">
									<i class="fas fa-upload"></i><% if (typeof lang == 'undefined' || lang == 'en') { %>Choose a file..<% } else if (lang == 'nl') { %>Bestand kiezen..<% } %>
								</span>
							</label>
							<input type="file" name="blogpost_file" id="blogpost_file" value="">
							<label for="filename" class="hide">
								uploaded file
							</label>
							<input type="text" id="filename" autocomplete="off" readonly placeholder="<% if (typeof lang == 'undefined' || lang == 'en') { %>No file selected, with this action you will overwrite the old upload(file)<% } else if (lang == 'nl') { %>Geen bestand geselecteerd , u overschrijft de vorige upload(bestand) hiermee.<% } %>">

						</div>
					<% } else if (lang == 'nl') { %>
						<header>
							<label for="blogpost_title_nl">Titel:</label>
							<input type="text" id="blogpost_title_nl" name="blogpost_title_nl"/>
							<label for="blogpost_title">Titel (EN):</label>
							<input type="text" id="blogpost_title" name="blogpost_title"/>
						</header>
						<div class="body">
							<label for="blogpost_body_nl">Inhoud:</label>
							<textarea type="text" id="blogpost_body_nl" name="blogpost_body_nl"/></textarea>
							<label for="blogpost_body">Inhoud (EN):</label>
							<textarea type="text" id="blogpost_body" name="blogpost_body"/></textarea>

							<label for="blogpost_file" id="buttonlabel">
								<span role="button" aria-controls="filename" tabindex="0">
									<i class="fas fa-upload"></i><% if (typeof lang == 'undefined' || lang == 'en') { %>Choose a file..<% } else if (lang == 'nl') { %>Bestand kiezen..<% } %>
								</span>
							</label>
							<input type="file" name="blogpost_file" id="blogpost_file" value="">
							<label for="filename" class="hide">
								uploaded file
							</label>
							<input type="text" id="filename" autocomplete="off" readonly placeholder="<% if (typeof lang == 'undefined' || lang == 'en') { %>No file selected, with this action you will overwrite the old upload(file)<% } else if (lang == 'nl') { %>Geen bestand geselecteerd , u overschrijft de vorige upload(bestand) hiermee.<% } %>">


						</div>

					<% } %>
					<footer>


						<!-- <pre>Date: <%= timeStampFormat %></pre> -->
						<input type="hidden" name="blogpost_unique_date" value="<%= uniqueTimeStamp %>"/>
						<input type="hidden" name="blogpost_date" value="<%= timeStamp %>"/>
						<input type="hidden" name="blogpost_date_format" value="<%= timeStampFormat %>"/>
					</footer>
					<input type="submit" value="<% if (typeof lang == 'undefined' || lang == 'en') { %>Send<% } else if (lang == 'nl') { %>Verzenden<% } %>">
				</form>
			</article>
		<% } %>

		<%	if ( username && !admin) { %>
			<div class="adminPanel">
				<a href="/toc">Configuration</a>
			</div>
		<% } else if (username && admin ) { %>
			<div class="adminPanel">
				<!-- <form id="adminPost" action="/admin_cm/post" method="post">
					<input id="jsonParser" type="text" name="_jsonParser" hidden="true" value="">
					<input id="currentPageVar" type="text" name="currentPageVar" hidden="true" value='<%= title %>'>
					<input id="admin_ApplyButton" name="button" value="Apply">
					<input id="admin_SafeButton" name="button" value="Save" type="submit">
				</form> -->
				<a href="/toc">Configuration</a>

				<div id="setAdmin" hidden="true">toggle setAdmin</div>
			</div>
		<% } %>

		<input id="jsonConverter" type="text" name="_jsonConverter" hidden="true" value='<%= _jsonConverter %>'>

	</section>

	<% if (typeof lang == 'undefined' || lang == 'en') { %>
		<iframe id="eofbot" src="/chatbot_en/chatbot.html" width="300" height="500px"></iframe>
	<% } else if (lang == 'nl') { %>
		<iframe id="eofbot" src="/chatbot_nl/chatbot.html" width="300" height="500px"></iframe>
	<% } %>

	<footer class="fluid-container">
		<div class="row-12">
			Copyright 2018 <a href="http://www.e-office.com">E-Office</a>
		</div>
	</footer>
	<script type="text/javascript">
	$(document).ready(function() {

		// TOGGLE EDIT FORM
		var editButton = $('.blog_edit_button');
		editButton.click(function() {
			postForm = $(this).siblings('.blog_post_form');
			currentForm = $(this).siblings('.currentForm');
			postForm.toggleClass('closed');
			currentForm.toggleClass('closed');
		});

		//EDIT POST - FORM
		$('.extra span[role=button]').on('keypress keyup click', function(e) {
			var currentID = '#' + $(this).parent().siblings('input').attr('id');
			console.log(currentID)
			// console.log($(this).parent().siblings('.blogpost_file_edit'))
		  // if(e.which === 32 || e.which === 13){
			// 	e.preventDefault();
			// 	$(this).parent().siblings('.blogpost_file_edit').click();
		  // }
			$(currentID).change(function(e) {
			  var filename_edit = $(this).val().split('\\').pop();
				var copyLabel = $(this).siblings('.filename_edit');
			  $(copyLabel[0]).val(filename_edit);
			  $(copyLabel[0]).attr('placeholder', filename_edit);
			  $(copyLabel[0]).focus();
			});
		});

	//UPLOAD FORM - ORIGINAL
	// $('#buttonlabel span[role=button]').bind('keypress keyup', function(e) {
	// 	console.log('click')
	//   if(e.which === 32 || e.which === 13){
	//     e.preventDefault();
	//     $('#blogpost_file').click();
	//   }
	// });
	// return chosen filename to additional input
	$('#blogpost_file').change(function(e) {
	  var filename = $('#blogpost_file').val().split('\\').pop();
		console.log(filename)
	  $('#filename').val(filename);
	  $('#filename').attr('placeholder', filename);
	  $('#filename').focus();
	});

	// if checkbox checked then show div > and post values for uploadfile
	$('input[type="checkbox"]').change(function() {
		// console.log($(this))
		$(this).siblings('.extra').toggle();
	});

	$('#eofbot').on('load', function(){
		var wavy = $(this).contents().find("#wavy");
		var eofbot = $('#eofbot');
		$(this).contents().find("#wavy").on('click', function(event) {
			available = eofbot.contents().find(".botname span", eofbot);
			console.log(available)
			function toggleText() {
				if (available[0].innerHTML === "available") {
					available[0].innerHTML = "Chatting";
				} else {
					available[0].innerHTML = "available";
				}
			}
			$('#eofbot').toggleClass('active');
			toggleText();
		});
	});
});
</script>
<script src=".././lib/domJSON.js"></script>
<script type="text/javascript" src="../scripts/admin_cm.js"></script>
<script type="text/javascript" src="../scripts/custom_menu.js"></script>
</body>
</html>
